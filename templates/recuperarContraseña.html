{% extends 'navbar.html' %}
{% load static %}

{% block extra_css %}
<link rel="stylesheet" href="{% static 'CSS/login.css' %}">
{% endblock %}

{% block title %}
    Recuperar Contrase√±a
{% endblock title %}

{% block cuerpo %}
<div class="container mt-4 w-25 mb-4" id="contenedor_login">
    <h4 class="text-center">Recuperar Contrase√±a</h4>

    <div class="d-flex justify-content-center mt-4">
        <img src="{% static 'images/logo_lilis.png' %}" alt="">
    </div>

    <form method="POST" action="{% url 'recuperarContrase√±a' %}">
        {% csrf_token %}
        {% if not ocultar_email %}
        <p class="mt-4">
            Ingrese su correo asociado. Se le enviar√° un c√≥digo para recuperar su contrase√±a.
        </p>
            <!-- üîµ Caso 1: usuario com√∫n ‚Äî mostrar campo email -->
            <input type="email"
                   name="email"
                   class="form-control"
                   placeholder="username@correo.cl"
                   required>
        {% else %}
            <!-- üîµ Caso 2: viene desde login (primer acceso) ‚Äî ocultar campo -->
            <input type="hidden" name="email" value="{{ email_session }}">

            <div class="alert alert-info mt-2">
                <strong>Correo detectado:</strong> {{ email_session }} <br>
                Se requiere actualizar su contrase√±a antes del primer inicio de sesi√≥n.
            </div>
        {% endif %}

        {% if messages %}
            {% for message in messages %}
                <div class="alert alert-{{ message.tags }} mt-3">{{ message }}</div>
            {% endfor %}
        {% endif %}

        <div class="d-flex mt-4">
            <button type="submit" class="btn btn-primary flex-fill">Enviar correo</button>
        </div>
    </form>

    <a class="d-flex justify-content-center mt-3" href="{% url 'login' %}">
        Volver al Inicio de Sesi√≥n
    </a>
</div>
{% endblock %}
