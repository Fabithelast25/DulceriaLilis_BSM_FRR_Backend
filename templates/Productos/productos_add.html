<!DOCTYPE html>
{% load static %}
<html lang="es">
<head>
  <meta charset="UTF-8" />
  <title>Agregar Producto</title>
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/css/bootstrap.min.css" rel="stylesheet">
  <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/js/bootstrap.bundle.min.js"></script>
  <script src="https://cdn.jsdelivr.net/npm/sweetalert2@11"></script>

  <style>
    /* ===== Paleta ===== */
    :root{
      --brand-red:#c8102e;
      --brand-red-700:#a40d25;
      --brand-red-50:#fff5f7;
      --brand-gold:#d4af37;
      --brand-gold-700:#b89617;
      --brand-gold-100:#fcf6e6;
      --ink:#1c1d22;
      --muted:#6b7280;
      --border:#e8e8e8;
      --bg:#ffffff;
      --page:#fafafa;
      --shadow:0 10px 24px rgba(0,0,0,.08);
      --radius:14px;
    }

    html,body{height:100%}
    body{
      background: linear-gradient(180deg, var(--page), #fff);
      margin:0; font-family: system-ui, Segoe UI, Roboto, Arial, sans-serif; color:var(--ink);
    }

    /* Navbar consistente */
    .navbar{
      background: var(--brand-red) !important;
      box-shadow: 0 8px 18px rgba(200,16,46,.18);
    }
    .navbar-brand{ color:#fff !important; font-weight:800; letter-spacing:.3px; }
    .nav-link{ color:#fff !important; opacity:.95; }
    .nav-link:hover{ opacity:1; text-decoration: underline; text-underline-offset: 4px; }

    /* Contenedor tarjeta */
    .page-wrap{ padding:24px 12px; }
    .card{
      max-width:980px; margin:0 auto; background:var(--bg); border-radius:var(--radius);
      box-shadow:var(--shadow); border:1px solid var(--border); overflow:hidden;
    }
    .card-header{
      display:flex; align-items:center; justify-content:space-between; gap:10px;
      background: linear-gradient(180deg, #fff, var(--brand-gold-100));
      border-bottom:2px solid var(--brand-gold);
      padding:14px 18px; font-weight:800; font-size:1.1rem; color:var(--ink);
    }
    .card-header:before{
      content:""; width:10px; height:22px; border-radius:8px;
      background: linear-gradient(180deg, var(--brand-gold), var(--brand-gold-700));
      box-shadow:0 4px 10px rgba(212,175,55,.25);
    }
    .body{ padding:18px; }

    /* Tabs / pasos */
    .steps{ display:flex; gap:8px; flex-wrap:wrap; margin-bottom:14px; }
    .btn-step{ background:#fff; border:1px solid var(--border); border-radius:10px; padding:9px 12px; font-weight:700; }
    .btn-step.active{ border-color:var(--brand-gold); box-shadow:0 0 0 .2rem rgba(212,175,55,.18); }

    .form-section{ display:none; } .form-section.active{ display:block; }

    /* Campos */
    label{ font-weight:700; margin-bottom:6px; display:block; }
    .form-control, .form-select, textarea{
      width:100%; border:1px solid var(--border); border-radius:10px; padding:10px 12px; background:#fff;
    }
    .form-control:focus, .form-select:focus, textarea:focus{
      border-color: var(--brand-gold); box-shadow: 0 0 0 .2rem rgba(212,175,55,.18);
    }
    .help{ font-size:.9rem; color:var(--muted); margin-top:4px; }
    .field-errors, .field-error{ color:#8f0c1f; font-weight:600; font-size:.9rem; margin-top:6px; display:none; }
    .invalid{ border-color:#dc3545 !important; box-shadow:0 0 0 .2rem rgba(220,53,69,.15) !important; }

    .non-field-errors{
      background:#fff3cd; border:1px solid #ffe08a; color:#7a5b00; padding:10px; border-radius:10px; margin-bottom:12px;
    }

    /* Botones */
    .actions{ display:flex; gap:10px; justify-content:flex-end; margin-top:16px; }
    .btn-gold{
      background: linear-gradient(180deg, var(--brand-gold), var(--brand-gold-700));
      color:#1a1a1a; border:none; border-radius:10px; padding:10px 14px; font-weight:800;
    }
    .btn-gold:hover{ filter:brightness(.95); color:#111; }
    .btn-outline{
      background:#fff; color:var(--brand-red); border:2px solid var(--brand-red); border-radius:10px; padding:9px 14px; font-weight:800;
    }
    .btn-outline:hover{ background:var(--brand-red-50); }

    @media (max-width: 720px){ .grid{ grid-template-columns:1fr; } }
  </style>
</head>
<body>

  {% include 'Productos/navbar_productos.html' %}

  <div class="page-wrap">
    <div class="card">
      <div class="card-header">
        <div>Agregar Producto</div>
        <a class="btn btn-outline" href="{% url 'productos' %}">Volver a la lista</a>
      </div>

      <div class="body">
        {% if form.non_field_errors %}
          <div class="non-field-errors">{{ form.non_field_errors }}</div>
        {% endif %}
        {% if errors %}
          <div class="non-field-errors">
            <ul class="mb-0">
              {% for field_errors in errors.values %}
                {% for error in field_errors %}<li>{{ error }}</li>{% endfor %}
              {% endfor %}
            </ul>
          </div>
        {% endif %}

        <!-- Pasos -->
        <div class="steps">
          <button type="button" class="btn-step active" data-section="form1">1. Identificaci√≥n y precios</button>
          <button type="button" class="btn-step" data-section="form2">2. Stock y control</button>
          <button type="button" class="btn-step" data-section="form3">3. Relaciones y derivados</button>
        </div>

        <form method="post" id="form_producto" novalidate>
          {% csrf_token %}

          <!-- ========== Secci√≥n 1 ========== -->
          <section id="form1" class="form-section active">
            <h5 class="mb-3">Identificaci√≥n</h5>
            <div class="row g-3">
              <div class="col-md-4">
                <label for="{{ form.sku.id_for_label }}">SKU*</label>
                {{ form.sku }}
                <div class="field-error" id="err-sku">Formato inv√°lido (3‚Äì32: letras/n√∫meros/._-)</div>
                {% if form.sku.errors %}
                <div id="err-sku-server" class="field-error text-danger fw-bold" style="display:block;">
                    {{ form.sku.errors.0 }}
                </div>
                {% endif %}
              </div>
              <div class="col-md-4">
                <label for="{{ form.ean_upc.id_for_label }}">EAN/UPC</label>
                {{ form.ean_upc }}
                <div class="field-error" id="err-ean">Debe ser num√©rico de 8, 12 o 13 d√≠gitos (opcional).</div>
                {% if form.ean_upc.errors %}
                <div id="err-ean_upc-server" class="field-error text-danger fw-bold" style="display:block;">
                    {{ form.ean_upc.errors.0 }}
                </div>
                {% endif %}
              </div>
              <div class="col-md-4">
                <label for="{{ form.nombre.id_for_label }}">Nombre*</label>
                {{ form.nombre }}
                <div class="field-error" id="err-nombre">Entre 3 y 70 caracteres.</div>
              </div>

              <div class="col-12">
                <label for="{{ form.descripcion.id_for_label }}">Descripci√≥n</label>
                {{ form.descripcion }}
                <div class="field-error" id="err-desc">M√°x. 300 caracteres.</div>
              </div>

              <div class="col-md-6">
                <label for="{{ form.categoria.id_for_label }}">Categor√≠a*</label>
                {{ form.categoria }}
                <div class="field-error" id="err-categoria">Selecciona una categor√≠a v√°lida.</div>
              </div>
              <div class="col-md-6">
                <label for="{{ form.marca.id_for_label }}">Marca</label>
                {{ form.marca }}
                <div class="field-error" id="err-marca">M√°x. 50 caracteres.</div>
                {% if form.marca.errors %}
                    <div class="text-danger">
                        {{ form.marca.errors }}
                    </div>
                {% endif %}
              </div>
              <div class="col-md-6">
                <label for="{{ form.modelo.id_for_label }}">Modelo</label>
                {{ form.modelo }}
                <div class="field-error" id="err-modelo">M√°x. 50 caracteres.</div>
                {% if form.modelo.errors %}
                    <div class="text-danger">
                        {{ form.modelo.errors }}
                    </div>
                {% endif %}
              </div>
            </div>

            <h5 class="mt-4 mb-3">Unidades y precios</h5>
            <div class="row g-3">
              <div class="col-md-4">
                <label for="{{ form.uom_compra.id_for_label }}">Unidad de Medida (Compra)*</label>
                {{ form.uom_compra }}
                <div class="field-error" id="err-uomc">Obligatorio.</div>
              </div>
              <div class="col-md-4">
                <label for="{{ form.uom_venta.id_for_label }}">Unidad de Medida (Venta)*</label>
                {{ form.uom_venta }}
                <div class="field-error" id="err-uomv">Obligatorio.</div>
              </div>
              <div class="col-md-4">
                <label for="{{ form.factor_conversion.id_for_label }}">Factor de Conversi√≥n</label>
                {{ form.factor_conversion }}
                <div class="field-error" id="err-factor">Entero &gt; 0.</div>
                {% if form.factor_conversion.errors %}
                    <div class="text-danger">
                        {{ form.factor_conversion.errors }}
                    </div>
                {% endif %}
              </div>
              <div class="col-md-3">
                <label for="{{ form.costo_estandar.id_for_label }}">Costo Est√°ndar</label>
                {{ form.costo_estandar }}
                <div class="field-error" id="err-costo-std">Entero ‚â• 0 (opcional).</div>
                {% if form.costo_estandar.errors %}
                    <div class="text-danger">
                        {{ form.costo_estandar.errors }}
                    </div>
                {% endif %}
              </div>
              <div class="col-md-3">
                <label for="{{ form.costo_promedio.id_for_label }}">Costo Promedio</label>
                {{ form.costo_promedio }}
                <div class="field-error" id="err-costo-prom">Entero ‚â• 0 (opcional).</div>
                {% if form.costo_promedio.errors %}
                    <div class="text-danger">
                        {{ form.costo_promedio.errors }}
                    </div>
                {% endif %}
              </div>
              <div class="col-md-3">
                <label for="{{ form.precio_venta.id_for_label }}">Precio de Venta</label>
                {{ form.precio_venta }}
                <div class="field-error" id="err-precio">Entero ‚â• 0 (opcional).</div>
                {% if form.precio_venta.errors %}
                    <div class="text-danger">
                        {{ form.precio_venta.errors }}
                    </div>
                {% endif %}
              </div>
              <div class="col-md-3">
                <label for="{{ form.impuesto_iva.id_for_label }}">IVA (%)*</label>
                {{ form.impuesto_iva }}
                <div class="field-error" id="err-iva">0 a 100.</div>
              </div>
            </div>
          </section>

          <!-- ========== Secci√≥n 2 ========== -->
          <section id="form2" class="form-section">
            <h5 class="mb-3">Stock y control</h5>
            <div class="row g-3">
              <div class="col-md-4">
                <label for="{{ form.stock_minimo.id_for_label }}">Stock M√≠nimo*</label>
                {{ form.stock_minimo }}
                <div class="field-error" id="err-smin">Entero ‚â• 0.</div>
                {% if form.stock_minimo.errors %}
                    <div class="text-danger">
                        {{ form.stock_minimo.errors }}
                    </div>
                {% endif %}
              </div>
              <div class="col-md-4">
                <label for="{{ form.stock_maximo.id_for_label }}">Stock M√°ximo</label>
                {{ form.stock_maximo }}
                <div class="field-error" id="err-smax">El stock m√°ximo no puede ser menor que el stock m√≠nimo.</div>
                {% if form.stock_maximo.errors %}
                    <div class="text-danger">
                        {{ form.stock_maximo.errors }}
                    </div>
                {% endif %}
              </div>
              <div class="col-md-4">
                <label for="{{ form.punto_reorden.id_for_label }}">Punto de Reorden</label>
                {{ form.punto_reorden }}
                <div class="field-error" id="err-reorden"> El punto de reorden debe estar entre el stock m√≠nimo y el stock m√°ximo.</div>
                {% if form.punto_reorden.errors %}
                    <div class="text-danger">
                        {{ form.punto_reorden.errors }}
                    </div>
                {% endif %}
              </div>

              <div class="col-md-4">
                <label for="{{ form.perishable.id_for_label }}">Perecible*</label>
                {{ form.perishable }}
              </div>
              <div class="col-md-4">
                <label for="{{ form.control_por_lote.id_for_label }}">Control por Lote*</label>
                {{ form.control_por_lote }}
              </div>
              <div class="col-md-4">
                <label for="{{ form.control_por_serie.id_for_label }}">Control por Serie*</label>
                {{ form.control_por_serie }}
              </div>
            </div>
          </section>

          <!-- ========== Secci√≥n 3 ========== -->
          <section id="form3" class="form-section">
            <h5 class="mb-3">Relaciones y soporte</h5>
            <div class="row g-3">
              <div class="col-md-6">
                <label for="{{ form.imagen_url.id_for_label }}">Imagen URL</label>
                {{ form.imagen_url }}
                <div class="field-error" id="err-url">Debe ser http(s) v√°lido (opcional).</div>
              </div>
              <div class="col-md-6">
                <label for="{{ form.ficha_tecnica_url.id_for_label }}">Ficha T√©cnica URL</label>
                {{ form.ficha_tecnica_url }}
                <div class="field-error" id="err-ficha">Debe ser http(s) v√°lido (opcional).</div>
              </div>
            </div>

            <h5 class="mt-4 mb-2">Derivados</h5>
            <div class="row g-3">
              <div class="col-md-4">
                <label for="{{ form.stock_actual.id_for_label }}">Stock Actual*</label>
                {{ form.stock_actual }}
                {% if form.stock_actual.errors %}
                    <div class="text-danger">
                        {{ form.stock_actual.errors }}
                    </div>
                {% endif %}
              </div>
              <div class="col-md-4">
                <label for="{{ form.alerta_bajo_stock.id_for_label }}">Alerta de Bajo Stock*</label>
                {{ form.alerta_bajo_stock }}
              </div>
              <div class="col-md-4">
                <label for="{{ form.alerta_por_vencer.id_for_label }}">Alerta de Vencimiento*</label>
                {{ form.alerta_por_vencer }}
              </div>
            </div>
          </section>

          <div class="actions">
            <a class="btn btn-outline" href="{% url 'productos' %}">Cancelar</a>
            <button type="submit" class="btn-gold">Guardar</button>
          </div>
        </form>
      </div>
    </div>
  </div>
    

  <script>
    /* ---------- Navegaci√≥n de secciones ---------- */
    document.querySelectorAll('.btn-step').forEach(b=>{
      b.addEventListener('click',()=>{
        document.querySelectorAll('.btn-step').forEach(x=>x.classList.remove('active'));
        document.querySelectorAll('.form-section').forEach(x=>x.classList.remove('active'));
        b.classList.add('active');
        document.getElementById(b.dataset.section).classList.add('active');
      });
    });

    /* ---------- Reglas y helpers de validaci√≥n ---------- */
    const RE = {
      sku: /^[A-Za-z0-9._-]{3,32}$/,
      ean: /^(?:\d{8}|\d{12}|\d{13})$/,
      entero: /^\d+$/,
      pct: /^(?:\d{1,3})$/,
      url: /^$|^https?:\/\/.+/i
    };
    const q = name => document.querySelector(`[name="${name}"]`);
    function showErr(el, ok, id){
      const msg = document.getElementById(id);
      if(!ok){ el?.classList.add('invalid'); if(msg) msg.style.display='block'; }
      else { el?.classList.remove('invalid'); if(msg) msg.style.display='none'; }
      return ok;
    }
    function sanitizeInteger(el){
      if(!el) return;
      el.value = el.value.replace(/[^\d]/g,''); // solo d√≠gitos
    }
    function setAttrs(){
      // Atributos HTML para bloquear negativos en el navegador
      ['factor_conversion','costo_estandar','costo_promedio','precio_venta','impuesto_iva',
       'stock_minimo','stock_maximo','punto_reorden','stock_actual'].forEach(n=>{
        const el = q(n); if(!el) return;
        el.setAttribute('inputmode','numeric'); el.setAttribute('min','0'); el.setAttribute('step','1');
        el.addEventListener('input', ()=>sanitizeInteger(el));
      });
      // Evita editar derivados si quieres (si el widget no ven√≠a disabled)
    }
    setAttrs();

    function validar() {
      let ok = true;

      ok &= showErr(q('sku'), RE.sku.test(q('sku').value), 'err-sku');
      ok &= showErr(q('ean_upc'), (q('ean_upc').value==='' || RE.ean.test(q('ean_upc').value)), 'err-ean');
      ok &= showErr(q('nombre'), q('nombre').value.trim().length>=3 && q('nombre').value.trim().length<=70, 'err-nombre');
      ok &= showErr(q('descripcion'), q('descripcion').value.length<=300, 'err-desc');

      ok &= showErr(q('categoria'), q('categoria').value!=='', 'err-categoria');
      ok &= showErr(q('marca'), (q('marca').value||'').length<=50, 'err-marca');
      ok &= showErr(q('modelo'), (q('modelo').value||'').length<=50, 'err-modelo');

      ok &= showErr(q('uom_compra'), q('uom_compra').value!=='', 'err-uomc');
      ok &= showErr(q('uom_venta'), q('uom_venta').value!=='', 'err-uomv');

      ok &= showErr(q('factor_conversion'),
        RE.entero.test(q('factor_conversion').value) && Number(q('factor_conversion').value) > 0, 'err-factor');

      const enteroVacioOK = (el)=> (el.value==='' || (RE.entero.test(el.value) && Number(el.value) >= 0));
      ok &= showErr(q('costo_estandar'), enteroVacioOK(q('costo_estandar')), 'err-costo-std');
      ok &= showErr(q('costo_promedio'), enteroVacioOK(q('costo_promedio')), 'err-costo-prom');
      ok &= showErr(q('precio_venta'),  enteroVacioOK(q('precio_venta')),  'err-precio');

      ok &= showErr(q('impuesto_iva'),
        RE.pct.test(q('impuesto_iva').value) && Number(q('impuesto_iva').value)>=0 && Number(q('impuesto_iva').value)<=100,
        'err-iva');

      ok &= showErr(q('stock_minimo'), RE.entero.test(q('stock_minimo').value), 'err-smin');
      ok &= showErr(q('stock_maximo'), enteroVacioOK(q('stock_maximo')), 'err-smax');
      ok &= showErr(q('punto_reorden'), enteroVacioOK(q('punto_reorden')), 'err-reorden');

      // Consistencias
      if(ok){
        const smin = Number(q('stock_minimo').value);
        const smax = q('stock_maximo').value==='' ? null : Number(q('stock_maximo').value);
        const reo  = q('punto_reorden').value==='' ? smin : Number(q('punto_reorden').value);

        // Validaci√≥n personalizada del punto de reorden
        // Permitimos 0 siempre
        if (reo !== 0) {
            // Si no es 0, debe estar entre smin y smax (si existe)
            if (reo < smin) {
                showErr(q('punto_reorden'), false, 'err-reorden');
                ok = false;
            }
            if (smax !== null && reo > smax) {
                showErr(q('punto_reorden'), false, 'err-reorden');
                ok = false;
            }
        }
      }

      ok &= showErr(q('imagen_url'), RE.url.test(q('imagen_url').value), 'err-url');
      ok &= showErr(q('ficha_tecnica_url'), RE.url.test(q('ficha_tecnica_url').value), 'err-ficha');

      return !!ok;
    }

    // Limpieza de error al digitar
    document.addEventListener('input', e=>{
      if(e.target.classList.contains('invalid')){
        e.target.classList.remove('invalid');
        const map = {sku:'err-sku', ean_upc:'err-ean', nombre:'err-nombre', descripcion:'err-desc',
          categoria:'err-categoria', marca:'err-marca', modelo:'err-modelo',
          uom_compra:'err-uomc', uom_venta:'err-uomv', factor_conversion:'err-factor',
          costo_estandar:'err-costo-std', costo_promedio:'err-costo-prom', precio_venta:'err-precio',
          impuesto_iva:'err-iva', stock_minimo:'err-smin', stock_maximo:'err-smax',
          punto_reorden:'err-reorden', imagen_url:'err-url', ficha_tecnica_url:'err-ficha'};
        const id = map[e.target.name]; if(id){ const m = document.getElementById(id); if(m) m.style.display='none'; }
      }
    });

    // Submit con validaci√≥n y autocompletado de punto_reorden si vac√≠o
    document.getElementById('form_producto').addEventListener('submit', function(e){
      // si punto_reorden est√° vac√≠o, setear al m√≠nimo (como en tu save())
      if(q('punto_reorden') && q('punto_reorden').value===''){
        q('punto_reorden').value = q('stock_minimo')?.value || 0;
      }
      if(!validar()){
        e.preventDefault();
        const first = document.querySelector('.invalid');
        if(first){
          const section = first.closest('.form-section')?.id || 'form1';
          document.querySelectorAll('.btn-step').forEach(x=>x.classList.remove('active'));
          document.querySelectorAll('.form-section').forEach(x=>x.classList.remove('active'));
          document.querySelector(`.btn-step[data-section="${section}"]`)?.classList.add('active');
          document.getElementById(section)?.classList.add('active');
          first.focus();

          // üîî Nuevo: SweetAlert de error gen√©rico
          Swal.fire({
            icon: 'error',
            title: 'Verifica los campos',
            text: 'Por favor corrige los errores indicados en el formulario antes de continuar.',
            confirmButtonColor: '#c8102e'
          });
        }
      }
    });

    document.addEventListener("DOMContentLoaded", function () {
    const serverErr = document.getElementById("err-sku-server");

    if (serverErr && serverErr.style.display !== "none") {
        Swal.fire({
            icon: 'error',
            title: 'SKU duplicado',
            text: 'Ya existe un producto registrado con este SKU. Por favor usa uno distinto.',
            confirmButtonColor: '#c8102e'
        });
    }
  });

  document.addEventListener("DOMContentLoaded", function () {
    const sku = document.getElementById("id_sku");  // Ajusta si tu input tiene otro id
    const serverErr = document.getElementById("err-sku-server");

    if (sku) {
        sku.addEventListener("input", () => {
            if (serverErr) {
                serverErr.style.display = "none";
            }
        });
    }
  });
  document.addEventListener("DOMContentLoaded", function () {
    const serverErrEAN = document.getElementById("err-ean_upc-server");

    if (serverErrEAN && serverErrEAN.style.display !== "none") {
        Swal.fire({
            icon: 'error',
            title: 'EAN/UPC inv√°lido',
            text: 'Ya existe un producto registrado con este EAN/UPC. Por favor usa uno distinto.',
            confirmButtonColor: '#c8102e'
        });
    }
  });

  document.addEventListener("DOMContentLoaded", function () {
    const ean = document.getElementById("id_ean_upc");  // Django genera id='id_nombreCampo'
    const serverErrEAN = document.getElementById("err-ean_upc-server");

    if (ean) {
        ean.addEventListener("input", () => {
            if (serverErrEAN) {
                serverErrEAN.style.display = "none";
            }
        });
    }
  });
  </script>

  <script>
      document.addEventListener("DOMContentLoaded", function () {

          // Campos a validar (seg√∫n sus IDs generados por Django)
          const campos = [
              "id_costo_promedio",
              "id_costo_estandar",
              "id_precio_venta",
              "id_stock_minimo",
              "id_stock_maximo",
              "id_stock_actual",
              "id_punto_reorden"
          ];

          campos.forEach(campoId => {
              const input = document.getElementById(campoId);

              if (input) {
                  // Permite solo n√∫meros y m√°ximo 6 d√≠gitos
                  input.setAttribute("maxlength", "6");

                  input.addEventListener("input", function () {
                      // Eliminar cualquier cosa que no sea n√∫mero
                      input.value = input.value.replace(/[^0-9]/g, "");

                      // Limitar a 6 d√≠gitos estrictos
                      if (input.value.length > 6) {
                          input.value = input.value.slice(0, 6);
                      }
                  });
              }
          });

      });
      </script>

      <script>
        document.addEventListener("DOMContentLoaded", function () {
            const iva = document.getElementById("id_impuesto_iva");

            iva.addEventListener("input", function () {
                // Solo permitir n√∫meros
                this.value = this.value.replace(/[^\d]/g, "");

                // Bloquear valores mayores a 100
                if (Number(this.value) > 100) {
                    this.value = "100";
                }
            });
        });
      </script>



      {% if messages %}
  <script>
      {% for message in messages %}
          Swal.fire({
              icon: "{{ message.tags }}",
              title: "{{ message }}",
              timer: 1500,
              showConfirmButton: false
          }).then(() => {
              // Rediriges cuando el SweetAlert desaparece
              window.location.href = "{% url 'productos' %}";
          });
      {% endfor %}
  </script>
  {% endif %}
  
</body>
</html>
